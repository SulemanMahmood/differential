\begin{figure}
\centering
\begin{tabular}{c}
\begin{lstlisting}
nsresult SetTextInternal (int textLength, int aCount,
                          int aLength, int aOffset,
                          PRUnichar * aBuffer) {
  PRInt32 newLength = textLength - aCount + aLength ;
  PRUnichar * to;
    ...
    (*@\textbf{$(*)_1$}@*)
  memcpy (to + aOffset , aBuffer ,
          aLength * sizeof ( PRUnichar ));
    ...
}
\end{lstlisting}
\\
Original
\\
\hline
\\
\begin{lstlisting}
nsresult SetTextInternal (int textLength, int aCount,
                          int aLength, int aOffset,
                          PRUnichar * aBuffer) {
  PRInt32 newLength = textLength - aCount + aLength ;
  PRUnichar * to;
    ...
  (*@\textbf{if ((unsigned)newLength > (1 << 29))}@*)
    (*@\textbf{return NS\_ERROR\_DOM\_DOMSTRING\_SIZE\_ERR;}@*)
    (*@\textbf{$(*)_1$}@*)
  memcpy (to + aOffset , aBuffer ,
          aLength * sizeof ( PRUnichar ));
    ...
}
\end{lstlisting}
\\
Patched
\end{tabular}
\caption{Original and patched version of Mozilla Firefox \scode{/content/base/src/nsGenericDOMDataNode.cpp} v3.5-3.6.4 module}
\figlabel{FirefoxExample}
\end{figure}